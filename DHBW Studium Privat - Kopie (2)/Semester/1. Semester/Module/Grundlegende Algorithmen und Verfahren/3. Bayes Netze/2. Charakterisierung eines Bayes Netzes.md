- Ein **Bayes Netz** ist eine **Menge von Ereignissen** $A_1,A_2,\ldots,A_n$.
- Die **Ereignisse** sind **Knoten** eines **gerichteten  Graphen**.
- Dabei hat der **Graph keine Schleifen** (**er ist azyklisch**).
- Es gibt **keine Kanten** zwischen **unabhängigen und bedingt unabhängigen Ereignissen**.
- Zu jedem **Ereignis** $A_i$ ist eine **Tabelle bedingter Wahrscheinlichkeiten** der **Form**:
$$
P(A_i \mid Eltern(A_i))
$$
- mit der **Menge** $Eltern(A_i)$ von **Elternknoten** von $A_i$.
- Diese **Tabellen** nennt man ***CPT*** (conditional probability table).

## Beispiel: Bob's Alarmanlage
- Folgende **Ereignisse** werden **modelliert**
	- $A$: Ein **Einbruch findet statt**
	- $B$: Ein **Erdbeben findet statt**
	- $C$: Der **Alarm** wird **ausgelöst**
	- $D$: **John ruft** bei **Bob** an
	- $E$: **Mary ruft** bei **Bob** an
![[Pasted image 20240223123143.png]]

| $x$                              | $P(c \mid x)$ |
| -------------------------------- | ------------- |
| $A \cap B$                       | $0,95$        |
| $\overline{A} \cap B$            | $0,29$        |
| $A \cap \overline{B}$            | $0,94$        |
| $\overline{A} \cap \overline{B}$ | $0,001$       |

---

| $x$ | $P(D \mid x)$ |
| ---- | ---- |
| $C$ | $0,90$ |
| $\overline{C}$ | $0,05$ |

---

| $x$ | $P(E \mid x)$ |
| ---- | ---- |
| $C$ | $0,70$ |
| $\overline{C}$ | $0,01$ |
### Schlussregeln
1. **Sensitivität der Alarmmelder**
	- $P(D \mid A)$: Die **Wahrscheinlichkeit**, dass **John bei Bob** anruft, falls ein **Einbruch** stattgefunden hat.
	$$
	P(D \mid A) = \frac{P(D \cap A)}{P(A)} =\frac{P(D \cap A \cap C) + P(D \cap A \cap \overline{C})}{P(A)}
	$$
	- **weiterhin:**
	$$
	\begin{align}
	P(D \cap A \cap C) &= P(D \mid A \cap C) · P(A \cap C) \\
	&= P(D \mid A \cap C) · P(C \mid A) · P(A) \\
	&= P(D \mid C) · P(C \mid A) · P(A)
	\end{align}
	$$
	- **analog**:
	$$
	\begin{align}
	P(D \cap A \cap \overline{C}) &= P(D \mid \overline{C}) · P(\overline{C} \mid A) · P(A) \\
	& mit \ P(\overline{C} \mid A) = 1- P(C \mid A)
	\end{align}
	$$
	- **unbekannt ist noch**:
	$$
	\begin{align}
	P(C \mid A) &= \frac{P(C \cap A)}{P(A)} \\
	&= \frac{P(C \cap A \cap \overline{B})}{P(A)} \\
	&= \frac{P(C \mid A \cap B) · P(A \cap B ) + P(C \mid A \cap \overline{B}) · P(A \cap \overline{B})}{P(A)} \\
	&= \frac{P(C \mid A \cap B) · P(A) · P(B) + P(C \mid A \cap \overline{B}) · P(A) · P(\overline{B})}{P(A)} \\
	&= P(C \mid A \cap B) · P(B) + P(C \mid A \cap \overline{B}) · (1-P(B))
	\end{align}
	$$
	- **Einsetzen ergibt**:
	$$
	\begin{align}
	P(D \mid A) = 0,849 \\
	P(E \mid A) = 0,659 \\
	P(D \cup E \mid A) = 0,915
	\end{align}
	$$
---
- Sind $A$ und $B$ **unabhängig**, dann gilt:
$$
\begin{align}
P(A \cap B) = P(A) · P(B) \\
P(A \mid B) = P(A)
\end{align}
$$
- Sind $A$ und $B$ **bedingt unabhängig**, gegeben $C$, dann:
$$
\begin{align}
P(A \cap B \mid C) &= P(A \mid C) · P(B \mid C) \\
P(A \mid B \cap C) &= P(A \mid C), P(B \mid A \cap C) = P(B \mid C)
\end{align}
$$

### Frage: wie groß ist die Sensitivität der Alarmmelder John und Mary?
- Das bedeutet:
	$P(D \mid A)$ und $P(E \mid A)$
	$$
\begin{align}
P(D \mid A) = 0,849 \\
P(E \mid A) = 0,659 \\
P(D \cup E \mid A) = 0,915
\end{align}
	$$
	- Interessanter ist $P(A \mid D)$, das ist die **Wahrscheinlichkeit**, dass ein **Einbruch stattgefunden hat**, wenn **John anruft**.
	- **Analog $P(A \mid E)$.
	- Jetzt wird die **Formel von Bayes angewendet:**
	$$
	\begin{align}
	P(A \mid D) &= \frac{P(D \mid A) · P(A)}{P(D \mid A) · P(A) + P(D \mid \overline{A}) · P(\overline{A})} \\
	&= \frac{P(D \mid A) · P(A)}{P(D \mid A) P(A) + P(D \mid \overline{A}) · (1 -P(A) )}
	\end{align}
	$$
	- es fehlt noch $P(D \mid \overline{A})$
	- Analog zur **Ableitung** von $P(D \mid A)$ lässt dich **ableiten**:
	$$
P(D \mid \overline{A}) = P(D \mid C) · P(C \mid \overline{A}) + P(D \mid \overline{C}) · P(\overline{C} \mid \overline{A})
	$$
	- unbekannt: $P(C \mid \overline{A})$ und $P(\overline{C}) \mid \overline{A} = 1- P(C \mid \overline{A})$
	- **Analog** zur **Ableitung** von $P(C \mid A)$ erhält man
	$$
P(C \mid \overline{A}) = P(C \mid \overline{A} \cap B) · P(B) + P(C \mid \overline{A} \cap \overline{B})(1-P(B))
	$$
	$\Rightarrow P(A \mid D) = 0,016$
	- Analog: $P(A \mid E) = 0,056$
	- Wenn beide anrufen: $P(A \mid D \cap E)$
		- **Diese Wahrscheinlichkeit beträgt $28 \%$**